\hypertarget{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity}{}\section{com.\+jack.\+motorbikestatistics.\+Maps\+Activity Class Reference}
\label{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity}\index{com.\+jack.\+motorbikestatistics.\+Maps\+Activity@{com.\+jack.\+motorbikestatistics.\+Maps\+Activity}}


Maps activity class for displaying map data.  


Inheritance diagram for com.\+jack.\+motorbikestatistics.\+Maps\+Activity\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity}
\end{center}
\end{figure}
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \hyperlink{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_1_1_statistic_window_adapter}{Statistic\+Window\+Adapter}
\begin{DoxyCompactList}\small\item\em Adapter used for displaying statistics at a certain marker that user has clicked on. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_aefa35b548b2f39bb46b2cb5024be383c}{on\+Map\+Ready} (Google\+Map google\+Map)
\begin{DoxyCompactList}\small\item\em Manipulates the map once available. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_afd23eb0cf651de276a9b85bb5fa609b8}{on\+Create} (Bundle saved\+Instance\+State)
\begin{DoxyCompactList}\small\item\em Fills our maps array with points to plot on the map. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
boolean \hyperlink{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_a0c72fcb79424420c3477add9ba6ab447}{get\+J\+S\+O\+N\+Objects} ()
\begin{DoxyCompactList}\small\item\em Gets point data and convert to array of J\+S\+ON objects. \end{DoxyCompactList}\item 
J\+S\+O\+N\+Object \hyperlink{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_ae5478e56dfb617433d0dfaeb94a403c7}{find\+J\+S\+O\+N\+By\+Lat\+Lng} (Lat\+Lng position)
\begin{DoxyCompactList}\small\item\em Finds J\+S\+O\+N\+Object from Array\+List via L\+A\+T/\+L\+NG coordinates. \end{DoxyCompactList}\item 
float \hyperlink{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_af4feb7617c02a59c62d6e9257914e997}{calc\+Distance} (Lat\+Lng start, Lat\+Lng end)
\begin{DoxyCompactList}\small\item\em Calculates the absolute distance between two points. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_aaace5219464acf3df9ac5e9ce913eef5}\label{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_aaace5219464acf3df9ac5e9ce913eef5}} 
Google\+Map \hyperlink{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_aaace5219464acf3df9ac5e9ce913eef5}{m\+Map}
\begin{DoxyCompactList}\small\item\em Google maps object for plotting. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_aaed26c36e08dad942830ab52d9d75d2e}\label{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_aaed26c36e08dad942830ab52d9d75d2e}} 
Array\+List$<$ J\+S\+O\+N\+Object $>$ \hyperlink{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_aaed26c36e08dad942830ab52d9d75d2e}{json\+List} = new Array\+List$<$J\+S\+O\+N\+Object$>$()
\begin{DoxyCompactList}\small\item\em Array\+List holding all trip data. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Maps activity class for displaying map data. 

\subsection{Member Function Documentation}
\mbox{\Hypertarget{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_afd23eb0cf651de276a9b85bb5fa609b8}\label{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_afd23eb0cf651de276a9b85bb5fa609b8}} 
\index{com\+::jack\+::motorbikestatistics\+::\+Maps\+Activity@{com\+::jack\+::motorbikestatistics\+::\+Maps\+Activity}!on\+Create@{on\+Create}}
\index{on\+Create@{on\+Create}!com\+::jack\+::motorbikestatistics\+::\+Maps\+Activity@{com\+::jack\+::motorbikestatistics\+::\+Maps\+Activity}}
\subsubsection{\texorpdfstring{on\+Create()}{onCreate()}}
{\footnotesize\ttfamily void com.\+jack.\+motorbikestatistics.\+Maps\+Activity.\+on\+Create (\begin{DoxyParamCaption}\item[{Bundle}]{saved\+Instance\+State }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}}



Fills our maps array with points to plot on the map. 

Called when maps activity is first started. Responsible for making sure we have points to plot.


\begin{DoxyParams}{Parameters}
{\em saved\+Instance\+State} & -\/ Information holding last previous state. \\
\hline
\end{DoxyParams}


References com.\+jack.\+motorbikestatistics.\+Maps\+Activity.\+get\+J\+S\+O\+N\+Objects().


\begin{DoxyCode}
56                                                        \{
57         super.onCreate(savedInstanceState);
58         setContentView(R.layout.activity\_maps);
59         \textcolor{comment}{// Obtain the SupportMapFragment and get notified when the map is ready to be used.}
60         SupportMapFragment mapFragment = (SupportMapFragment) getSupportFragmentManager()
61                 .findFragmentById(R.id.map);
62 
63         \hyperlink{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_a0c72fcb79424420c3477add9ba6ab447}{getJSONObjects}();
64 
65         mapFragment.getMapAsync(\textcolor{keyword}{this});
66     \}
\end{DoxyCode}
\mbox{\Hypertarget{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_a0c72fcb79424420c3477add9ba6ab447}\label{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_a0c72fcb79424420c3477add9ba6ab447}} 
\index{com\+::jack\+::motorbikestatistics\+::\+Maps\+Activity@{com\+::jack\+::motorbikestatistics\+::\+Maps\+Activity}!get\+J\+S\+O\+N\+Objects@{get\+J\+S\+O\+N\+Objects}}
\index{get\+J\+S\+O\+N\+Objects@{get\+J\+S\+O\+N\+Objects}!com\+::jack\+::motorbikestatistics\+::\+Maps\+Activity@{com\+::jack\+::motorbikestatistics\+::\+Maps\+Activity}}
\subsubsection{\texorpdfstring{get\+J\+S\+O\+N\+Objects()}{getJSONObjects()}}
{\footnotesize\ttfamily boolean com.\+jack.\+motorbikestatistics.\+Maps\+Activity.\+get\+J\+S\+O\+N\+Objects (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Gets point data and convert to array of J\+S\+ON objects. 

Gets an arraylist of strings passed via a bundle to this activity. These strings are there converted back to J\+S\+ON objects which will be used for plotting. The reason for not passing straight J\+S\+ON objects is because they are not serializable and passable between activities.

\begin{DoxyReturn}{Returns}
boolean -\/ Whether all objects were able to be created. 
\end{DoxyReturn}

\begin{DoxyCode}
80     \{
81         \textcolor{keywordtype}{boolean} result = \textcolor{keyword}{true};
82 
83         \textcolor{comment}{/*}
84 \textcolor{comment}{         * Get our serialized arrayList of jsonStrings}
85 \textcolor{comment}{         * then convert them back to jsonObjects}
86 \textcolor{comment}{         */}
87         ArrayList<String> jsonStrings = (ArrayList<String>)getIntent().getSerializableExtra(\textcolor{stringliteral}{"JSONList"});
88         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < jsonStrings.size(); i++)
89         \{
90             \textcolor{keywordflow}{try}
91             \{
92                 JSONObject jsonObject = \textcolor{keyword}{new} JSONObject(jsonStrings.get(i));
93                 \hyperlink{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_aaed26c36e08dad942830ab52d9d75d2e}{jsonList}.add(jsonObject);
94             \}
95             \textcolor{keywordflow}{catch} (JSONException e)
96             \{
97                 result = \textcolor{keyword}{false};
98             \}
99         \}
100 
101         \textcolor{keywordflow}{return} result;
102     \}
\end{DoxyCode}
\mbox{\Hypertarget{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_ae5478e56dfb617433d0dfaeb94a403c7}\label{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_ae5478e56dfb617433d0dfaeb94a403c7}} 
\index{com\+::jack\+::motorbikestatistics\+::\+Maps\+Activity@{com\+::jack\+::motorbikestatistics\+::\+Maps\+Activity}!find\+J\+S\+O\+N\+By\+Lat\+Lng@{find\+J\+S\+O\+N\+By\+Lat\+Lng}}
\index{find\+J\+S\+O\+N\+By\+Lat\+Lng@{find\+J\+S\+O\+N\+By\+Lat\+Lng}!com\+::jack\+::motorbikestatistics\+::\+Maps\+Activity@{com\+::jack\+::motorbikestatistics\+::\+Maps\+Activity}}
\subsubsection{\texorpdfstring{find\+J\+S\+O\+N\+By\+Lat\+Lng()}{findJSONByLatLng()}}
{\footnotesize\ttfamily J\+S\+O\+N\+Object com.\+jack.\+motorbikestatistics.\+Maps\+Activity.\+find\+J\+S\+O\+N\+By\+Lat\+Lng (\begin{DoxyParamCaption}\item[{Lat\+Lng}]{position }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Finds J\+S\+O\+N\+Object from Array\+List via L\+A\+T/\+L\+NG coordinates. 


\begin{DoxyParams}{Parameters}
{\em position} & -\/ Latitude and Longitude position. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
J\+S\+O\+N\+Object -\/ The found J\+S\+ON object. 
\end{DoxyReturn}


References gps\+J\+S\+ON.


\begin{DoxyCode}
110                                                          \{
111         JSONObject result = null;
112 
113         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \hyperlink{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_aaed26c36e08dad942830ab52d9d75d2e}{jsonList}.size(); i++) \{
114             JSONObject tmpJSON = \hyperlink{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_aaed26c36e08dad942830ab52d9d75d2e}{jsonList}.get(i);
115 
116             \textcolor{keywordflow}{try} \{
117                 JSONObject \hyperlink{logging-device_8ino_a548727e041a5cd3db91bdbd0ccd71e30}{gpsJSON} = tmpJSON.getJSONObject(\textcolor{stringliteral}{"gps"});
118 
119                 Double latitude = gpsJSON.getDouble(\textcolor{stringliteral}{"lat"});
120                 Double longitude = gpsJSON.getDouble(\textcolor{stringliteral}{"lng"});
121 
122                 \textcolor{comment}{/* Check to see if latitude and logitudes match */}
123                 \textcolor{keywordflow}{if} ((latitude == position.latitude) && (longitude == position.longitude)) \{
124                     result = tmpJSON;
125                     \textcolor{keywordflow}{break};
126                 \}
127 
128             \} \textcolor{keywordflow}{catch} (JSONException e) \{
129                 \textcolor{comment}{/* Do nothing */}
130             \}
131         \}
132 
133         \textcolor{keywordflow}{return} result;
134     \}
\end{DoxyCode}
\mbox{\Hypertarget{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_af4feb7617c02a59c62d6e9257914e997}\label{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_af4feb7617c02a59c62d6e9257914e997}} 
\index{com\+::jack\+::motorbikestatistics\+::\+Maps\+Activity@{com\+::jack\+::motorbikestatistics\+::\+Maps\+Activity}!calc\+Distance@{calc\+Distance}}
\index{calc\+Distance@{calc\+Distance}!com\+::jack\+::motorbikestatistics\+::\+Maps\+Activity@{com\+::jack\+::motorbikestatistics\+::\+Maps\+Activity}}
\subsubsection{\texorpdfstring{calc\+Distance()}{calcDistance()}}
{\footnotesize\ttfamily float com.\+jack.\+motorbikestatistics.\+Maps\+Activity.\+calc\+Distance (\begin{DoxyParamCaption}\item[{Lat\+Lng}]{start,  }\item[{Lat\+Lng}]{end }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Calculates the absolute distance between two points. 

Distance is as the crow flys and not via streets etc. 
\begin{DoxyParams}{Parameters}
{\em start} & -\/ Start position. \\
\hline
{\em end} & -\/ End position. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
flaot -\/ Distance between points in metres. 
\end{DoxyReturn}

\begin{DoxyCode}
145     \{
146         \textcolor{keywordtype}{float}[] results = \textcolor{keyword}{new} \textcolor{keywordtype}{float}[1];
147 
148         Location.distanceBetween(start.latitude, start.longitude, end.latitude, end.longitude, results);
149         \textcolor{keywordflow}{return} results[0];
150     \}
\end{DoxyCode}
\mbox{\Hypertarget{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_aefa35b548b2f39bb46b2cb5024be383c}\label{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_aefa35b548b2f39bb46b2cb5024be383c}} 
\index{com\+::jack\+::motorbikestatistics\+::\+Maps\+Activity@{com\+::jack\+::motorbikestatistics\+::\+Maps\+Activity}!on\+Map\+Ready@{on\+Map\+Ready}}
\index{on\+Map\+Ready@{on\+Map\+Ready}!com\+::jack\+::motorbikestatistics\+::\+Maps\+Activity@{com\+::jack\+::motorbikestatistics\+::\+Maps\+Activity}}
\subsubsection{\texorpdfstring{on\+Map\+Ready()}{onMapReady()}}
{\footnotesize\ttfamily void com.\+jack.\+motorbikestatistics.\+Maps\+Activity.\+on\+Map\+Ready (\begin{DoxyParamCaption}\item[{Google\+Map}]{google\+Map }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Manipulates the map once available. 

This callback is triggered when the map is ready to be used. This is where we can add markers or lines.

If Google Play services is not installed on the device, the user will be prompted to install it inside the Support\+Map\+Fragment. This method will only be triggered once the user has installed Google Play services and returned to the app.


\begin{DoxyParams}{Parameters}
{\em google\+Map} & -\/ Our map object ready to manipulate. \\
\hline
\end{DoxyParams}


References com.\+jack.\+motorbikestatistics.\+Maps\+Activity.\+calc\+Distance(), and gps\+J\+S\+ON.


\begin{DoxyCode}
165                                                 \{
166         \hyperlink{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_aaace5219464acf3df9ac5e9ce913eef5}{mMap} = googleMap;
167 
168         \hyperlink{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_aaace5219464acf3df9ac5e9ce913eef5}{mMap}.setMapType(GoogleMap.MAP\_TYPE\_HYBRID);
169 
170         \textcolor{comment}{/* Set our info window adapter class that is shown when marker clicked */}
171         \hyperlink{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_aaace5219464acf3df9ac5e9ce913eef5}{mMap}.setInfoWindowAdapter(\textcolor{keyword}{new} StatisticWindowAdapter());
172 
173         \textcolor{comment}{/* If we have no data don't bother plotting points */}
174         \textcolor{keywordflow}{if} (\hyperlink{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_aaed26c36e08dad942830ab52d9d75d2e}{jsonList}.size() != 0)
175         \{
176             \textcolor{comment}{/* lineOpts will store our route */}
177             PolylineOptions lineOpts = \textcolor{keyword}{new} PolylineOptions();
178             lineOpts.color(Color.parseColor( \textcolor{stringliteral}{"#CC0000FF"}));
179             lineOpts.width(5);
180             lineOpts.visible(\textcolor{keyword}{true});
181 
182             \textcolor{keywordflow}{try}
183             \{
184                 LatLng lastMarker = null;
185 
186                 \textcolor{comment}{/* Plot every point in the our JSONObject array */}
187                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \hyperlink{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_aaed26c36e08dad942830ab52d9d75d2e}{jsonList}.size(); i++)
188                 \{
189                     JSONObject rootJSON = \hyperlink{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_aaed26c36e08dad942830ab52d9d75d2e}{jsonList}.get(i);
190                     JSONObject \hyperlink{logging-device_8ino_a548727e041a5cd3db91bdbd0ccd71e30}{gpsJSON} = rootJSON.getJSONObject(\textcolor{stringliteral}{"gps"});
191 
192                     Double lat = gpsJSON.getDouble(\textcolor{stringliteral}{"lat"});
193                     Double lng = gpsJSON.getDouble(\textcolor{stringliteral}{"lng"});
194                     LatLng location = \textcolor{keyword}{new} LatLng(lat, lng);
195 
196                     \textcolor{comment}{/* Add this location to our trip line */}
197                     lineOpts.add(location);
198 
199                     \textcolor{comment}{/*}
200 \textcolor{comment}{                     * Check if distance between this point and}
201 \textcolor{comment}{                     * last marker is greater than 5m otherwise don't add marker.}
202 \textcolor{comment}{                     * Adding markers every 5 metres prevents the map being spammed with}
203 \textcolor{comment}{                     * thousands of readings.}
204 \textcolor{comment}{                     */}
205                     \textcolor{keywordflow}{if} ((lastMarker == null) || (\hyperlink{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_af4feb7617c02a59c62d6e9257914e997}{calcDistance}(location, lastMarker) > 5))
206                     \{
207                         \textcolor{comment}{/* Only add a marker if the gps data is valid */}
208                         \textcolor{keywordflow}{if} (gpsJSON.getBoolean(\textcolor{stringliteral}{"gps\_valid"}) == \textcolor{keyword}{true}) \{
209                             MarkerOptions markerOptions = \textcolor{keyword}{new} MarkerOptions();
210                             markerOptions.position(location);
211                             markerOptions.title(\textcolor{stringliteral}{"Reading: "} + i);
212 
213                             \hyperlink{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_aaace5219464acf3df9ac5e9ce913eef5}{mMap}.addMarker(markerOptions);
214 
215                             lastMarker = location;
216 
217                             \textcolor{comment}{/* Changes camera to point to newest marker */}
218                             \hyperlink{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_aaace5219464acf3df9ac5e9ce913eef5}{mMap}.animateCamera(CameraUpdateFactory.newLatLngZoom(location, 12));
219                         \}
220                     \}
221 
222                 \}
223                 \hyperlink{classcom_1_1jack_1_1motorbikestatistics_1_1_maps_activity_aaace5219464acf3df9ac5e9ce913eef5}{mMap}.addPolyline(lineOpts);
224             \}
225             \textcolor{keywordflow}{catch} (JSONException e)
226             \{
227                 \textcolor{comment}{/* Do nothing */}
228             \}
229         \}
230     \}
\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
android-\/app/app/src/main/java/com/jack/motorbikestatistics/\hyperlink{_maps_activity_8java}{Maps\+Activity.\+java}\end{DoxyCompactItemize}
